@page "/settings"

@inject IStringLocalizer<Settings> StringLocalizer
@inject IStorageRepository StorageRepo
@inject NavigationManager NavManager

@using System.Globalization

<MatExpansionPanel>
    <MatExpansionPanelSummary>
        <MatExpansionPanelHeader>@StringLocalizer["Choose your language"]</MatExpansionPanelHeader>
    </MatExpansionPanelSummary>
    <MatExpansionPanelDetails>

        <MatSelect TValue="string" ValueChanged="v => SetLanguage(v)">
            <MatOptionString Value="en-US">English</MatOptionString>
            <MatOptionString Value="de-DE">Deutsh</MatOptionString>
            <MatOptionString Value="hu-HU">Magyar</MatOptionString>
        </MatSelect>
        
    </MatExpansionPanelDetails>
</MatExpansionPanel>



@code{
    async Task SetLanguage(string cultureInfo)
    {
        var culture = CultureInfo.GetCultureInfo(cultureInfo);
        CultureInfo.CurrentCulture = culture;
        CultureInfo.CurrentUICulture = culture;
        
        await StorageRepo.SetItem("lang", cultureInfo);

        //NavManager.NavigateTo("/", true);

        StateHasChanged();
    }
}